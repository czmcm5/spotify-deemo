"use strict";(self.webpackChunkspotify_deemo=self.webpackChunkspotify_deemo||[]).push([[852],{45:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(8587);function a(e,t){if(null==e)return{};var r,a,s=(0,n.A)(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)r=o[a],-1===t.indexOf(r)&&{}.propertyIsEnumerable.call(e,r)&&(s[r]=e[r])}return s}},1206:(e,t,r)=>{r.d(t,{A:()=>n});const n=r.p+"images/music.png?ver=708d7d1874e81d24a372040f4906d76d"},2483:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(7163),a=r(4848);const s=e=>{let{errMessage:t}=e;return(0,a.jsxs)(n.A,{severity:"error",children:[t," "]})}},2885:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(6540);const a=e=>{let{page:t,isLoading:r,isFinished:a,onIntersect:s}=e;(0,n.useEffect)((()=>{if(r)return;if(a)return;const e=new IntersectionObserver((e=>{e[0].isIntersecting&&s()}),{threshold:0}),n=document.getElementById("observer-".concat(t));return n&&e.observe(n),()=>{n&&e.unobserve(n)}}),[r,a,s])}},4064:(e,t,r)=>{r.d(t,{Dg:()=>l,Nt:()=>d,U4:()=>i,XI:()=>p,bt:()=>c,pR:()=>u});var n=r(3110),a=r(1083),s=r(5443),o=r(5800);const i=async e=>{let{limit:t,offset:r}=e;try{return(await s.A.get("/me/playlists",{params:{limit:t,offset:r}})).data}catch(e){throw new Error("실패: playlist 가져오기")}},c=async e=>{try{return(await s.A.get("/playlists/".concat(e.playlist_id),{params:e})).data}catch(e){var t;if(console.log(e),(0,n.F0)(e)&&401===(null===(t=e.response)||void 0===t?void 0:t.status))throw new Error("retry");throw new Error("fail getPlaylist")}},l=async e=>{try{return(await s.A.get("/playlists/".concat(e.playlist_id,"/tracks"),{params:e})).data}catch(e){throw new Error("fail getPlaylistItems")}},d=async(e,t)=>{try{const{name:r,collaborative:n,description:a}=t;return(await s.A.post("/users/".concat(e,"/playlists"),{name:r,public:t.public,collaborative:n,description:a})).data}catch(e){throw new Error("fail createPlaylist")}},p=async e=>{try{return(await s.A.post("/playlists/".concat(e.playlist_id,"/tracks"),e)).data}catch(e){var t;if((0,n.F0)(e)&&401===(null===(t=e.response)||void 0===t?void 0:t.status))throw new Error("retry");throw new Error("fail add item to playlist")}},u=async e=>{let{token:t,params:r}=e;try{return(await a.A.get("".concat(o.$,"/playlists/").concat(r.playlist_id,"/tracks"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},params:r})).data}catch(e){throw new Error("fail getPlaylistItems")}}},4690:(e,t,r)=>{r.d(t,{G:()=>s,r:()=>o});var n=r(8097),a=r(5800);const s=async()=>{const e=crypto.getRandomValues(new Uint8Array(64)).reduce(((e,t)=>e+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[t%62]),""),t=(r=await(async e=>{const t=(new TextEncoder).encode(e);return window.crypto.subtle.digest("SHA-256",t)})(e),btoa(String.fromCharCode(...new Uint8Array(r))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"));var r;const s=n.xl,o=a.f,i=n.iW,c=new URL("https://accounts.spotify.com/authorize");if(window.localStorage.setItem("code_verifier",e),s&&o){const e={response_type:"code",client_id:s,scope:i,code_challenge_method:"S256",code_challenge:t,redirect_uri:o};c.search=new URLSearchParams(Object.entries(e)).toString(),window.location.href=c.toString()}},o=()=>{localStorage.removeItem("code_verifier"),localStorage.removeItem("access_token"),window.location.href="/"}},4939:(e,t,r)=>{r.d(t,{A:()=>a});var n=r(6540);const a=()=>{const[e,t]=(0,n.useState)("none");return{isfocuse:e,on:()=>t("show"),off:()=>t("none")}}},5202:(e,t,r)=>{r.d(t,{A:()=>q});var n=r(7528),a=r(4651),s=r(5647),o=r(2885),i=r(6582),c=r(8975),l=r(2483),d=r(4812),p=r(4848);var u,g,h=r(5865),y=r(9494),m=r(6739),f=r(431);const v=()=>(0,p.jsxs)(A,{children:[(0,p.jsx)(y.A,{variant:"h2",fontWeight:700,children:"첫 번째 플레이리스트를 만드세요."}),(0,p.jsx)("div",{children:"어렵지 않아요. 저희가 도와드릴게요."}),(0,p.jsx)(w,{variant:"contained",color:"secondary",children:"플레이리스트 만들기"})]}),A=(0,m.Ay)("div")(u||(u=(0,n.A)(["\n  padding: 1.5rem;\n  margin-top: 0.5rem;\n  color: white;\n  background-color: #1a1a1a;\n  border-radius: 8;\n"]))),w=(0,m.Ay)(f.A)(g||(g=(0,n.A)(["\n  margin-top: 1rem;\n  font-weight: 700;\n"])));var b=r(4705),j=r(45),x=r(4939),O=r(1206);const k=r.p+"images/playIcon.png?ver=7a010c498114f1e71e07aada8cdfc680";var P,E,S;const I=["item","isSelect"];function _(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function F(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?_(Object(r),!0).forEach((function(t){(0,b.A)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):_(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}const L=e=>{var t;let{item:r,isSelect:n}=e,a=(0,j.A)(e,I);const s=(0,x.A)();return(0,p.jsxs)(C,F(F({},a),{},{className:n?"select":"",onMouseOver:s.on,onMouseLeave:s.off,children:[(0,p.jsxs)(N,{children:[(0,p.jsx)(B,{src:k,className:s.isfocuse}),r.images?(0,p.jsx)("img",{src:r.images[0].url,alt:"썸네일"}):(0,p.jsx)("img",{className:"musicIcon",src:O.A,alt:"음악 아이콘"})]}),(0,p.jsxs)("div",{children:[(0,p.jsx)(y.A,{fontSize:16,children:r.name}),(0,p.jsxs)(y.A,{color:"#B3B3B3",children:["플레이리스트 • ",(null==r||null===(t=r.owner)||void 0===t?void 0:t.display_name)||"알수없음"]})]})]}))},C=(0,m.Ay)("div")(P||(P=(0,n.A)(["\n  display: flex;\n  align-items: center;\n  padding: 0.6rem;\n  border-radius: 4px;\n  cursor: pointer;\n\n  &.select {\n    background-color: #404040;\n  }\n  &:hover {\n    background-color: #1c1c1c;\n  }\n"]))),N=(0,m.Ay)("div")(E||(E=(0,n.A)(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 3.5rem;\n  aspect-ratio: 1/1;\n  margin-right: 1rem;\n  border-radius: 4px;\n  overflow: hidden;\n  background-color: #313131;\n  img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n  img.musicIcon {\n    width: 70%;\n    height: 70%;\n  }\n"]))),B=(0,m.Ay)("img")(S||(S=(0,n.A)(["\n  display: none;\n  position: absolute;\n  background-color: #0000007f;\n  &.show {\n    display: block;\n  }\n"])));var U;const q=e=>{let{isMobile:t}=e;const r=(0,s.Zp)(),{id:n=""}=(0,s.g)(),{data:a}=(0,c.A)(),{data:u,isLoading:g,error:y,hasNextPage:m,fetchNextPage:f,isFetchingNextPage:A}=(0,i.A)({enabled:!!a}),w=t?"library-mobile":"library";(0,o.A)({page:w,isLoading:A,isFinished:!m,onIntersect:f});const b=(e=>{let{isLoading:t,isError:r,isEmpty:n=!1,EmptyComponet:a}=e;return t?(0,p.jsx)(d.A,{}):r?(0,p.jsx)(l.A,{errMessage:r.message}):n&&a?(0,p.jsx)(a,{}):null})({isEmpty:!a||!(null!=u&&u.pages)||0===u.pages[0].total,EmptyComponet:v,isLoading:g,isError:y});return b||(0,p.jsxs)(z,{children:[null==u?void 0:u.pages.map((e=>e.items.map(((e,t)=>(0,p.jsx)(L,{item:e,onClick:()=>(e=>r("/playlist/".concat(e)))(e.id||""),isSelect:n===e.id},t))))),(0,p.jsx)(h.A,{isLoading:A,isFinished:!m}),!A&&(0,p.jsx)(h.n,{id:"observer-".concat(w)})]})},z=(0,a.Ay)("div")(U||(U=(0,n.A)(["\n  height: 100%;\n  padding-bottom: 7rem;\n  overflow: scroll;\n"])))},5443:(e,t,r)=>{r.d(t,{A:()=>o});var n=r(1083),a=r(5800);const s=n.A.create({baseURL:a.$,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});s.interceptors.request.use((e=>(e.headers.Authorization="Bearer ".concat(localStorage.getItem("access_token")),e)));const o=s},5865:(e,t,r)=>{r.d(t,{A:()=>l,n:()=>p});var n,a,s=r(7528),o=r(4651),i=r(4812),c=r(4848);const l=e=>{let{isLoading:t,isFinished:r,showText:n=!0}=e;return(0,c.jsx)(d,{children:t?(0,c.jsx)(i.k,{width:30,height:30}):r&&n?(0,c.jsx)("div",{children:"마지막 입니다."}):(0,c.jsx)(c.Fragment,{})})},d=(0,o.Ay)("div")(n||(n=(0,s.A)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 3rem;\n  font-size: 14px;\n  color: #858585;\n"]))),p=(0,o.Ay)("div")(a||(a=(0,s.A)(["\n  height: 1rem;\n  /* background-color: yellow; */\n"])))},6582:(e,t,r)=>{r.d(t,{A:()=>s});var n=r(6475),a=r(4064);const s=e=>{let{limit:t=10,enabled:r}=e;return(0,n.q)({queryKey:["current-user-playlists"],queryFn:e=>{let{pageParam:r}=e;return(0,a.U4)({limit:t,offset:r})},enabled:r,initialPageParam:0,getNextPageParam:e=>{if(e.next){const t=new URL(e.next).searchParams.get("offset");return t?parseInt(t):void 0}}})}},8972:(e,t,r)=>{r.d(t,{A:()=>n});const n=r.p+"images/BookmarkIcon.png?ver=b29bf0ae7706e635c9f6294781e08862"},8975:(e,t,r)=>{r.d(t,{A:()=>i});var n=r(7286),a=r(4690),s=r(5443);const o=async()=>{try{return(await s.A.get("/me")).data}catch(e){throw(0,a.r)(),new Error("프로필 얻기 실패")}},i=()=>{const e=localStorage.getItem("access_token");return(0,n.I)({queryKey:["current-user-profile"],queryFn:o,enabled:!!e,staleTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,retry:1})}},9665:(e,t,r)=>{r.d(t,{A:()=>A});var n=r(7528),a=r(8957),s=r(9494),o=r(431),i=r(6739),c=r(9792),l=r(4848);const d=(0,c.A)((0,l.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var p=r(8972),u=r(7665),g=r(7097),h=r(4064),y=r(8975),m=r(4690);var f,v;const A=()=>{const{mutate:e}=(()=>{const e=(0,u.jE)(),{data:t}=(0,y.A)();return(0,g.n)({mutationFn:e=>t&&t.id?(0,h.Nt)(null==t?void 0:t.id,e):((0,m.G)(),Promise.reject(new Error("user is not defined"))),onSuccess:()=>{e.invalidateQueries({queryKey:["current-user-playlists"]})}})})();return(0,l.jsxs)(w,{children:[(0,l.jsxs)(a.A,{display:"flex",children:[(0,l.jsx)(b,{src:p.A,alt:"북마크 아이콘"}),(0,l.jsx)(s.A,{variant:"h2",fontWeight:700,children:"내 라이브러리"})]}),(0,l.jsx)(o.A,{onClick:()=>{e({name:"내 풀레이리스트"})},children:(0,l.jsx)(d,{})})]})},w=(0,i.Ay)("div")(f||(f=(0,n.A)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin: 1rem;\n"]))),b=(0,i.Ay)("img")(v||(v=(0,n.A)(["\n  width: 25px;\n  margin-right: 20px;\n"])))}}]);
//# sourceMappingURL=852.js.map?ver=cbbefe60358f9d293516