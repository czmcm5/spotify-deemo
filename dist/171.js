"use strict";(self.webpackChunkspotify_deemo=self.webpackChunkspotify_deemo||[]).push([[171],{1206:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"images/music.png?ver=708d7d1874e81d24a372040f4906d76d"},2483:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(7163),a=n(4848);const s=e=>{let{errMessage:t}=e;return(0,a.jsxs)(r.A,{severity:"error",children:[t," "]})}},2638:(e,t,n)=>{n.d(t,{A:()=>o});var r=n(7286),a=n(4690),s=n(5443);const i=async()=>{try{return(await s.A.get("/me")).data}catch(e){throw(0,a.r)(),new Error("프로필 얻기 실패")}},o=()=>{const e=localStorage.getItem("access_token");return(0,r.I)({queryKey:["current-user-profile"],queryFn:i,enabled:!!e,staleTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1,retry:1})}},3179:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(6540);const a=()=>{const[e,t]=(0,r.useState)("none");return{isfocuse:e,on:()=>t("show"),off:()=>t("none")}}},3413:(e,t,n)=>{n.d(t,{A:()=>a});var r=n(6540);const a=e=>{let{page:t,isLoading:n,isFinished:a,onIntersect:s}=e;(0,r.useEffect)((()=>{if(n)return;if(a)return;const e=new IntersectionObserver((e=>{e[0].isIntersecting&&s()}),{threshold:0}),r=document.getElementById("observer-".concat(t));return r&&e.observe(r),()=>{r&&e.unobserve(r)}}),[n,a,s])}},4018:(e,t,n)=>{n.d(t,{A:()=>L});var r,a,s=n(7528),i=n(4651),o=n(6739),c=n(2638),l=n(3413),d=n(4812),h=n(2483),g=n(5865),u=n(9494),p=n(9120),m=n(431),y=n(4848);const v=()=>(0,y.jsxs)(A,{children:[(0,y.jsx)(u.A,{variant:"h2",fontWeight:700,children:"첫 번째 플레이리스트를 만드세요."}),(0,y.jsx)("div",{children:"어렵지 않아요. 저희가 도와드릴게요."}),(0,y.jsx)(f,{variant:"contained",color:"secondary",children:"플레이리스트 만들기"})]}),A=(0,p.Ay)("div")(r||(r=(0,s.A)(["\n  padding: 1.5rem;\n  margin-top: 0.5rem;\n  color: white;\n  background-color: #1a1a1a;\n  border-radius: 8;\n"]))),f=(0,p.Ay)(m.A)(a||(a=(0,s.A)(["\n  margin-top: 1rem;\n  font-weight: 700;\n"])));var w=n(3179),x=n(1206);const b=n.p+"images/playIcon.png?ver=7a010c498114f1e71e07aada8cdfc680";var j,k,I;const _=e=>{var t;let{item:n,onClick:r,isSelect:a}=e;const s=(0,w.A)();return(0,y.jsxs)(P,{onClick:r,className:a?"select":"",onMouseOver:s.on,onMouseLeave:s.off,children:[(0,y.jsxs)(S,{children:[(0,y.jsx)(E,{src:b,className:s.isfocuse}),n.images?(0,y.jsx)("img",{src:n.images[0].url}):(0,y.jsx)("img",{className:"musicIcon",src:x.A})]}),(0,y.jsxs)("div",{children:[(0,y.jsx)(u.A,{fontSize:16,children:n.name}),(0,y.jsxs)(u.A,{color:"#B3B3B3",children:["플레이리스트 • ",(null==n||null===(t=n.owner)||void 0===t?void 0:t.display_name)||"알수없음"]})]})]})},P=(0,p.Ay)("div")(j||(j=(0,s.A)(["\n  display: flex;\n  align-items: center;\n  padding: 0.6rem;\n  border-radius: 4px;\n  cursor: pointer;\n\n  &.select {\n    background-color: #404040;\n  }\n  &:hover {\n    background-color: #1c1c1c;\n  }\n"]))),S=(0,p.Ay)("div")(k||(k=(0,s.A)(["\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  width: 3.5rem;\n  aspect-ratio: 1/1;\n  margin-right: 1rem;\n  border-radius: 4px;\n  overflow: hidden;\n  background-color: #313131;\n  img {\n    width: 100%;\n    height: 100%;\n    object-fit: cover;\n  }\n  img.musicIcon {\n    width: 70%;\n    height: 70%;\n  }\n"]))),E=(0,p.Ay)("img")(I||(I=(0,s.A)(["\n  display: none;\n  position: absolute;\n  background-color: #0000007f;\n  &.show {\n    display: block;\n  }\n"])));var F,C=n(5647);const L=e=>{let{isMoblie:t}=e;const n=(0,C.Zp)(),{id:r=""}=(0,C.g)(),{data:a}=(0,c.A)(),{data:s,isLoading:i,error:u,hasNextPage:p,fetchNextPage:m,isFetchingNextPage:A}=(0,o.A)({limit:10,enabled:!!a});return(0,l.A)({page:t?"library-mobile":"library",isLoading:A,isFinished:!p,onIntersect:m}),a?i?(0,y.jsx)(d.A,{}):u?(0,y.jsx)(h.A,{errMessage:u.message}):null!=s&&s.pages&&0!==s.pages[0].total?(0,y.jsxs)(M,{children:[s.pages.map((e=>e.items.map(((e,t)=>(0,y.jsx)(_,{item:e,onClick:()=>(e=>n("/playlist/".concat(e)))(e.id||""),isSelect:r===e.id},t))))),(0,y.jsx)(g.A,{isLoading:A,isFinished:!p}),!A&&(0,y.jsx)(g.n,{id:"observer-".concat(t?"library-mobile":"library")})]}):(0,y.jsx)(v,{}):(0,y.jsx)(v,{})},M=(0,i.Ay)("div")(F||(F=(0,s.A)(["\n  height: 100%;\n  padding-bottom: 7rem;\n  overflow: scroll;\n"])))},4064:(e,t,n)=>{n.d(t,{Dg:()=>l,Nt:()=>d,U4:()=>o,XI:()=>h,bt:()=>c,pR:()=>g});var r=n(3110),a=n(1083),s=n(5443),i=n(5800);const o=async e=>{let{limit:t,offset:n}=e;try{return(await s.A.get("/me/playlists",{params:{limit:t,offset:n}})).data}catch(e){throw new Error("실패: playlist 가져오기")}},c=async e=>{try{return(await s.A.get("/playlists/".concat(e.playlist_id),{params:e})).data}catch(e){var t;if(console.log(e),(0,r.F0)(e)&&401===(null===(t=e.response)||void 0===t?void 0:t.status))throw new Error("retry");throw new Error("fail getPlaylist")}},l=async e=>{try{return(await s.A.get("/playlists/".concat(e.playlist_id,"/tracks"),{params:e})).data}catch(e){throw new Error("fail getPlaylistItems")}},d=async(e,t)=>{try{const{name:n,collaborative:r,description:a}=t;return(await s.A.post("/users/".concat(e,"/playlists"),{name:n,public:t.public,collaborative:r,description:a})).data}catch(e){throw new Error("fail createPlaylist")}},h=async e=>{try{return(await s.A.post("/playlists/".concat(e.playlist_id,"/tracks"),e)).data}catch(e){var t;if((0,r.F0)(e)&&401===(null===(t=e.response)||void 0===t?void 0:t.status))throw new Error("retry");throw new Error("fail add item to playlist")}},g=async e=>{let{token:t,params:n}=e;try{return(await a.A.get("".concat(i.$,"/playlists/").concat(n.playlist_id,"/tracks"),{headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},params:n})).data}catch(e){throw new Error("fail getPlaylistItems")}}},4171:(e,t,n)=>{n.r(t),n.d(t,{default:()=>c});var r=n(6540),a=n(5647),s=n(4018),i=n(7761),o=n(4848);const c=()=>{const e=(0,a.Zp)();return(0,r.useEffect)((()=>{/Mobi|Android|iPhone|iPad/i.test(navigator.userAgent)||e("/")}),[]),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(i.A,{}),(0,o.jsx)(s.A,{isMoblie:!0})]})}},4690:(e,t,n)=>{n.d(t,{G:()=>s,r:()=>i});var r=n(8097),a=n(5800);const s=async()=>{const e=crypto.getRandomValues(new Uint8Array(64)).reduce(((e,t)=>e+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789"[t%62]),""),t=(n=await(async e=>{const t=(new TextEncoder).encode(e);return window.crypto.subtle.digest("SHA-256",t)})(e),btoa(String.fromCharCode(...new Uint8Array(n))).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"));var n;const s=r.xl,i=a.f,o=r.iW,c=new URL("https://accounts.spotify.com/authorize");if(window.localStorage.setItem("code_verifier",e),s&&i){const e={response_type:"code",client_id:s,scope:o,code_challenge_method:"S256",code_challenge:t,redirect_uri:i};c.search=new URLSearchParams(Object.entries(e)).toString(),window.location.href=c.toString()}},i=()=>{localStorage.removeItem("code_verifier"),localStorage.removeItem("access_token"),window.location.href="/"}},5443:(e,t,n)=>{n.d(t,{A:()=>i});var r=n(1083),a=n(5800);const s=r.A.create({baseURL:a.$,headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("access_token"))}});s.interceptors.request.use((e=>(e.headers.Authorization="Bearer ".concat(localStorage.getItem("access_token")),e)));const i=s},5865:(e,t,n)=>{n.d(t,{A:()=>l,n:()=>h});var r,a,s=n(7528),i=n(4651),o=n(4812),c=n(4848);const l=e=>{let{isLoading:t,isFinished:n,showText:r=!0}=e;return(0,c.jsx)(d,{children:t?(0,c.jsx)(o.k,{width:30,height:30}):n&&r?(0,c.jsx)("div",{children:"마지막 입니다."}):(0,c.jsx)(c.Fragment,{})})},d=(0,i.Ay)("div")(r||(r=(0,s.A)(["\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  height: 3rem;\n  font-size: 14px;\n  color: #858585;\n"]))),h=(0,i.Ay)("div")(a||(a=(0,s.A)(["\n  height: 1rem;\n  /* background-color: yellow; */\n"])))},6739:(e,t,n)=>{n.d(t,{A:()=>s});var r=n(6475),a=n(4064);const s=e=>{let{limit:t,enabled:n}=e;return(0,r.q)({queryKey:["current-user-playlists"],queryFn:e=>{let{pageParam:n}=e;return(0,a.U4)({limit:t,offset:n})},enabled:n,initialPageParam:0,getNextPageParam:e=>{if(e.next){const t=new URL(e.next).searchParams.get("offset");return t?parseInt(t):void 0}}})}},7761:(e,t,n)=>{n.d(t,{A:()=>f});var r=n(7528),a=n(8957),s=n(9494),i=n(431),o=n(9120),c=n(9792),l=n(4848);const d=(0,c.A)((0,l.jsx)("path",{d:"M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6z"}),"Add");var h=n(8972),g=n(7665),u=n(7097),p=n(4064),m=n(2638),y=n(4690);var v,A;const f=()=>{const{mutate:e}=(()=>{const e=(0,g.jE)(),{data:t}=(0,m.A)();return(0,u.n)({mutationFn:e=>t&&t.id?(0,p.Nt)(null==t?void 0:t.id,e):((0,y.G)(),Promise.reject(new Error("user is not defined"))),onSuccess:()=>{e.invalidateQueries({queryKey:["current-user-playlists"]})}})})();return(0,l.jsxs)(w,{children:[(0,l.jsxs)(a.A,{display:"flex",children:[(0,l.jsx)(x,{src:h.A,alt:"북마크 아이콘"}),(0,l.jsx)(s.A,{variant:"h2",fontWeight:700,children:"내 라이브러리"})]}),(0,l.jsx)(i.A,{onClick:()=>{e({name:"내 풀레이리스트"})},children:(0,l.jsx)(d,{})})]})},w=(0,o.Ay)("div")(v||(v=(0,r.A)(["\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin: 1rem;\n"]))),x=(0,o.Ay)("img")(A||(A=(0,r.A)(["\n  width: 25px;\n  margin-right: 20px;\n"])))},8972:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"images/BookmarkIcon.png?ver=b29bf0ae7706e635c9f6294781e08862"}}]);
//# sourceMappingURL=171.js.map?ver=6c0d59a2cc7d1c50792c